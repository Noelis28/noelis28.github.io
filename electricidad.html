<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/favicon.png') }}">
  <link rel="stylesheet" href="../static/css/style.css">
  <title>EcoHuella - Electricidad</title>
</head>
<body>
  <header class="header">
    <div class="header__text">
      <h1>Descubre tu Huella de Carbono con EcoHuella</h1>
      <p>¡Calcula, reduce y salva el planeta! Responde preguntas simples sobre tu estilo de vida y obtén consejos personalizados para un futuro sostenible.</p>
    </div>
  </header>




  <main>
    {% block content %}
    <h2 class="main__title">¿Cuánto consumes de electricidad en tu hogar? Selecciona tus hábitos principales</h2>
      
    <form id="electricidad-form" action="/calcular_electricidad" method="POST">
      <!-- Pregunta 1 -->
      <h3>¿Utilizas bombillas LED en tu hogar?</h3>
      <div class="question">
        <label><input type="radio" name="led" value="si"><img src="../static/img/si.png" alt="Sí"><span>Sí</span></label>
        <label><input type="radio" name="led" value="no"><img src="../static/img/no.png" alt="No"><span>No</span></label>
      </div>

      <!-- Pregunta 2 -->
      <h3>¿Apagas los electrodomésticos cuando no los usas?</h3>
      <div class="question">
        <label><input type="radio" name="apagar" value="si"><img src="../static/img/si.png" alt="Sí"><span>Sí</span></label>
        <label><input type="radio" name="apagar" value="no"><img src="../static/img/no.png" alt="No"><span>No</span></label>
      </div>

      <!-- Pregunta 3 -->
      <h3>¿Utilizas electrodomésticos de bajo consumo energético?</h3>
      <div class="question">
        <label><input type="radio" name="bajo_consumo" value="si"><img src="../static/img/si.png" alt="Sí"><span>Sí</span></label>
        <label><input type="radio" name="bajo_consumo" value="no"><img src="../static/img/no.png" alt="No"><span>No</span></label>
      </div>

      <!-- Pregunta 4 -->
      <h3>¿Cuántas horas al día utilizas aire acondicionado o calefacción?</h3>
      <div class="question">
        <label><input type="radio" name="climatizacion" value="bajo"><img src="../static/img/reloj.png" alt="Bajo"><span>Menos de 3 horas</span></label>
        <label><input type="radio" name="climatizacion" value="medio"><img src="../static/img/reloj.png" alt="Medio"><span>3-6 horas</span></label>
        <label><input type="radio" name="climatizacion" value="alto"><img src="../static/img/reloj.png" alt="Alto"><span>Más de 6 horas</span></label>
      </div>

      <!-- Pregunta 5 -->
      <h3>¿Cuántos dispositivos eléctricos usas simultáneamente en casa?</h3>
      <div class="question">
        <label><input type="radio" name="electro" value="bajo"><img src="../static/img/dispositivos.png" alt="Bajo"><span>1-2</span></label>
        <label><input type="radio" name="electro" value="medio"><img src="../static/img/dispositivos.png" alt="Medio"><span>3-5</span></label>
        <label><input type="radio" name="electro" value="alto"><img src="../static/img/dispositivos.png" alt="Alto"><span>Más de 5</span></label>
      </div>
    </form>
    {% endblock %}
  </main>

  <!-- Botón "Calcular" oculto inicialmente -->
  <button id="calcular-btn" type="submit" form="electricidad-form">Calcular</button>

  <footer></footer>

  <script>
    // Función para verificar si todas las preguntas están respondidas
    function checkForm() {
      const questions = document.querySelectorAll('.question');
      let allAnswered = true;
      questions.forEach(q => {
        const radios = q.querySelectorAll('input[type="radio"]');
        const checked = Array.from(radios).some(r => r.checked);
        if (!checked) allAnswered = false;
      });
      const btn = document.getElementById('calcular-btn');
      if (allAnswered) {
        btn.classList.add('visible');
      } else {
        btn.classList.remove('visible');
      }
    }

    // Función para manejar la selección persistente
    function handleSelection() {
        // Remover 'selected' de todos los labels en la misma pregunta
        const allLabels = document.querySelectorAll('.question label');
        allLabels.forEach(label => label.classList.remove('selected'));

        // Agregar 'selected' al label del radio button checked
        const checkedRadios = document.querySelectorAll('.question input[type="radio"]:checked');
        checkedRadios.forEach(radio => {
            const label = radio.closest('label'); // Encuentra el label padre
            if (label) label.classList.add('selected');
        });
    }

    // Agregar event listeners a todos los radio buttons
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', () => {
            handleSelection(); // Actualizar selección persistente
            checkForm(); // Verificar si todas están respondidas
        });
    });

    // Verificar al cargar la página
    window.addEventListener('load', () => {
        handleSelection(); // Aplicar selección si ya hay algo checked
        checkForm();
    });
    
  </script>
</body>
</html>